# 保险库接口

> **版本**: v1.0.0  
> **更新日期**: 2026-02-20  
> **作者**: Vaultly Team  
> **文档类型**: API 文档

---

## 版本历史

| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| v1.0.0 | 2026-02-20 | 初始版本 | Vaultly Team |

---

## 一、VaultService

### 1.1 条目 CRUD

#### addEntry

添加新条目。

```dart
Future<String> addEntry(VaultEntry entry)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| entry | VaultEntry | 是 | 要添加的条目 |

**返回：** string - 新条目的 ID

---

#### updateEntry

更新现有条目。

```dart
Future<void> updateEntry(VaultEntry entry)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| entry | VaultEntry | 是 | 要更新的条目（需包含 ID） |

**返回：** void

---

#### deleteEntry

删除条目。

```dart
Future<void> deleteEntry(String id)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | 是 | 要删除的条目 ID |

**返回：** void

---

#### getEntry

获取单个条目。

```dart
Future<VaultEntry?> getEntry(String id)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | 是 | 条目 ID |

**返回：** VaultEntry? - 条目（如果存在）

---

### 1.2 查询操作

#### getAllEntries

获取所有条目。

```dart
Future<List<VaultEntry>> getAllEntries()
```

**返回：** List<VaultEntry> - 所有条目列表

---

#### getEntriesByType

按类型获取条目。

```dart
Future<List<VaultEntry>> getEntriesByType(EntryType type)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| type | EntryType | 是 | 条目类型 |

**返回：** List<VaultEntry> - 符合条件的条目列表

---

#### searchEntries

搜索条目。

```dart
Future<List<VaultEntry>> searchEntries(String query)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| query | string | 是 | 搜索关键词 |

**返回：** List<VaultEntry> - 符合条件的条目列表

---

#### getFavorites

获取收藏的条目。

```dart
Future<List<VaultEntry>> getFavorites()
```

**返回：** List<VaultEntry> - 收藏的条目列表

---

#### getByTag

按标签获取条目。

```dart
Future<List<VaultEntry>> getByTag(String tag)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| tag | string | 是 | 标签名称 |

**返回：** List<VaultEntry> - 带有该标签的条目列表

---

### 1.3 标签管理

#### addTag

为条目添加标签。

```dart
Future<void> addTag(String entryId, String tag)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| entryId | string | 是 | 条目 ID |
| tag | string | 是 | 标签名称 |

**返回：** void

---

#### removeTag

移除条目的标签。

```dart
Future<void> removeTag(String entryId, String tag)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| entryId | string | 是 | 条目 ID |
| tag | string | 是 | 标签名称 |

**返回：** void

---

#### getAllTags

获取所有标签。

```dart
Future<List<String>> getAllTags()
```

**返回：** List<String> - 所有标签列表

---

### 1.4 收藏管理

#### toggleFavorite

切换收藏状态。

```dart
Future<void> toggleFavorite(String entryId)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| entryId | string | 是 | 条目 ID |

**返回：** void

---

## 二、PasswordGenerator

### 2.1 密码生成

#### generate

生成随机密码。

```dart
String generate({
  int length = 16,
  bool includeUppercase = true,
  bool includeLowercase = true,
  bool includeNumbers = true,
  bool includeSymbols = true,
  String? excludeChars,
})
```

**参数：**
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| length | int | 否 | 16 | 密码长度 |
| includeUppercase | bool | 否 | true | 包含大写字母 |
| includeLowercase | bool |否 | true | 包含小写字母 |
| includeNumbers | bool | 否 | true | 包含数字 |
| includeSymbols | bool | 否 | true | 包含特殊字符 |
| excludeChars | string? | 否 | null | 排除的字符 |

**返回：** string - 生成的密码

---

#### calculateStrength

计算密码强度。

```dart
int calculateStrength(String password)
```

**参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| password | string | 是 | 要评估的密码 |

**返回：** int - 强度分数 (0-100)

---

## 三、使用示例

### 3.1 添加登录凭证

```dart
final vaultService = VaultService();

final loginEntry = LoginEntry(
  title: 'Google',
  username: 'user@gmail.com',
  password: 'encrypted_password',
  url: 'https://google.com',
  totpSecret: 'JBSWY3DPEHPK3PXP',
);

final id = await vaultService.addEntry(loginEntry);
```

### 3.2 搜索条目

```dart
final vaultService = VaultService();
final results = await vaultService.searchEntries('google');
```

### 3.3 生成密码

```dart
final generator = PasswordGenerator();
final password = generator.generate(
  length: 20,
  includeSymbols: true,
);
```

---

## 四、相关文档

- [保险库模块](../03-模块设计/保险库模块.md) - 模块设计
- [数据字典](../04-数据模型/数据字典.md) - 数据结构
- [接口概览](./接口概览.md) - 接口概览
